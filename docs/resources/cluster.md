---
page_title: "redpanda_cluster Resource - terraform-provider-redpanda"
subcategory: ""
description: |-
  
---

# redpanda_cluster (Resource)



Enables the provisioning and management of Redpanda clusters on AWS and GCP. A cluster must always have a network and resource group.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_type` (String) Cluster type. Type is immutable and can only be set on cluster creation.
- `connection_type` (String) Cluster connection type. Private clusters are not exposed to the internet. For BYOC clusters, Private is best-practice.
- `name` (String) Unique name of the cluster.
- `network_id` (String) Network ID where cluster is placed.
- `resource_group_id` (String) Resource group ID of the cluster.
- `throughput_tier` (String) Throughput tier of the cluster.

### Optional

- `allow_deletion` (Boolean) Allows deletion of the cluster. Defaults to true. Should probably be set to false for production use.
- `aws_private_link` (Attributes) The AWS Private Link configuration. (see [below for nested schema](#nestedatt--aws_private_link))
- `azure_private_link` (Attributes) The Azure Private Link configuration. (see [below for nested schema](#nestedatt--azure_private_link))
- `cloud_provider` (String) Cloud provider where resources are created.
- `gcp_private_service_connect` (Attributes) The GCP Private Service Connect configuration. (see [below for nested schema](#nestedatt--gcp_private_service_connect))
- `http_proxy` (Attributes) HTTP Proxy properties. (see [below for nested schema](#nestedatt--http_proxy))
- `kafka_api` (Attributes) Cluster's Kafka API properties. (see [below for nested schema](#nestedatt--kafka_api))
- `read_replica_cluster_ids` (List of String) IDs of clusters which may create read-only topics from this cluster.
- `redpanda_version` (String) Current Redpanda version of the cluster.
- `region` (String) Cloud provider region. Region represents the name of the region where the cluster will be provisioned.
- `schema_registry` (Attributes) Cluster's Schema Registry properties. (see [below for nested schema](#nestedatt--schema_registry))
- `tags` (Map of String) Tags placed on cloud resources. If the cloud provider is GCP and the name of a tag has the prefix "gcp.network-tag.", the tag is a network tag that will be added to the Redpanda cluster GKE nodes. Otherwise, the tag is a normal tag. For example, if the name of a tag is "gcp.network-tag.network-tag-foo", the network tag named "network-tag-foo" will be added to the Redpanda cluster GKE nodes. Note: The value of a network tag will be ignored. See the details on network tags at https://cloud.google.com/vpc/docs/add-remove-network-tags.
- `zones` (List of String) Zones of the cluster. Must be valid zones within the selected region. If multiple zones are used, the cluster is a multi-AZ cluster.

### Read-Only

- `cluster_api_url` (String) The URL of the cluster API.
- `id` (String) ID of the cluster. ID is an output from the Create Cluster endpoint and cannot be set by the caller.

<a id="nestedatt--aws_private_link"></a>
### Nested Schema for `aws_private_link`

Required:

- `allowed_principals` (List of String) The ARN of the principals that can access the Redpanda AWS PrivateLink Endpoint Service. To grant permissions to all principals, use an asterisk (*).
- `connect_console` (Boolean) Whether Console is connected in Redpanda AWS Private Link Service.
- `enabled` (Boolean) Whether Redpanda AWS Private Link Endpoint Service is enabled.


<a id="nestedatt--azure_private_link"></a>
### Nested Schema for `azure_private_link`

Required:

- `allowed_subscriptions` (List of String) The subscriptions that can access the Redpanda Azure PrivateLink Endpoint Service. To grant permissions to all principals, use an asterisk (*).
- `connect_console` (Boolean) Whether Console is connected in Redpanda Azure Private Link Service.
- `enabled` (Boolean) Whether Redpanda Azure Private Link Endpoint Service is enabled.


<a id="nestedatt--gcp_private_service_connect"></a>
### Nested Schema for `gcp_private_service_connect`

Required:

- `consumer_accept_list` (Attributes List) List of consumers that are allowed to connect to Redpanda GCP PSC (Private Service Connect) service attachment. (see [below for nested schema](#nestedatt--gcp_private_service_connect--consumer_accept_list))
- `enabled` (Boolean) Whether Redpanda GCP Private Service Connect is enabled.
- `global_access_enabled` (Boolean) Whether global access is enabled.

<a id="nestedatt--gcp_private_service_connect--consumer_accept_list"></a>
### Nested Schema for `gcp_private_service_connect.consumer_accept_list`

Required:

- `source` (String) Either the GCP project number or its alphanumeric ID.



<a id="nestedatt--http_proxy"></a>
### Nested Schema for `http_proxy`

Required:

- `mtls` (Attributes) mTLS configuration. (see [below for nested schema](#nestedatt--http_proxy--mtls))

<a id="nestedatt--http_proxy--mtls"></a>
### Nested Schema for `http_proxy.mtls`

Required:

- `ca_certificates_pem` (List of String) CA certificate in PEM format.
- `enabled` (Boolean) Whether mTLS is enabled.
- `principal_mapping_rules` (List of String) Principal mapping rules for mTLS authentication. Only valid for Kafka API. See the Redpanda documentation on configuring authentication.



<a id="nestedatt--kafka_api"></a>
### Nested Schema for `kafka_api`

Required:

- `mtls` (Attributes) mTLS configuration. (see [below for nested schema](#nestedatt--kafka_api--mtls))

<a id="nestedatt--kafka_api--mtls"></a>
### Nested Schema for `kafka_api.mtls`

Required:

- `ca_certificates_pem` (List of String) CA certificate in PEM format.
- `enabled` (Boolean) Whether mTLS is enabled.
- `principal_mapping_rules` (List of String) Principal mapping rules for mTLS authentication. Only valid for Kafka API. See the Redpanda documentation on configuring authentication.



<a id="nestedatt--schema_registry"></a>
### Nested Schema for `schema_registry`

Required:

- `mtls` (Attributes) mTLS configuration. (see [below for nested schema](#nestedatt--schema_registry--mtls))

<a id="nestedatt--schema_registry--mtls"></a>
### Nested Schema for `schema_registry.mtls`

Required:

- `ca_certificates_pem` (List of String) CA certificate in PEM format.
- `enabled` (Boolean) Whether mTLS is enabled.
- `principal_mapping_rules` (List of String) Principal mapping rules for mTLS authentication. Only valid for Kafka API. See the Redpanda documentation on configuring authentication.

## Usage

### On AWS

```terraform
provider "redpanda" {}

resource "redpanda_resource_group" "test" {
  name = var.resource_group_name
}

resource "redpanda_network" "test" {
  name              = var.network_name
  resource_group_id = redpanda_resource_group.test.id
  cloud_provider    = var.cloud_provider
  region            = var.region
  cluster_type      = "dedicated"
  cidr_block        = "10.0.0.0/20"
}

resource "redpanda_cluster" "test" {
  name              = var.cluster_name
  resource_group_id = redpanda_resource_group.test.id
  network_id        = redpanda_network.test.id
  cloud_provider    = var.cloud_provider
  region            = var.region
  cluster_type      = "dedicated"
  connection_type   = "public"
  throughput_tier   = var.throughput_tier
  zones             = var.zones
  allow_deletion    = true
  tags = {
    "key" = "value"
  }
  aws_private_link = {
    enabled         = true
    connect_console = true
    allowed_principals = ["arn:aws:iam::123456789024:root"]
  }
}

variable "resource_group_name" {
  default = "testname"
}

variable "network_name" {
  default = "testname"
}

variable "cluster_name" {
  default = "testname"
}

variable "region" {
  default = "us-east-2"
}

variable "zones" {
  default = ["use2-az1", "use2-az2", "use2-az3"]
}

variable "cloud_provider" {
  default = "aws"
}

variable "throughput_tier" {
  default = "tier-1-aws-v2-arm"
}

resource "redpanda_user" "test" {
  name            = var.user_name
  password        = var.user_pw
  mechanism       = var.mechanism
  cluster_api_url = redpanda_cluster.test.cluster_api_url
}

resource "redpanda_topic" "test" {
  name               = var.topic_name
  partition_count    = var.partition_count
  replication_factor = var.replication_factor
  cluster_api_url    = redpanda_cluster.test.cluster_api_url
  allow_deletion     = true
}


resource "redpanda_acl" "test" {
  resource_type         = "TOPIC"
  resource_name         = redpanda_topic.test.name
  resource_pattern_type = "LITERAL"
  principal             = "User:${redpanda_user.test.name}"
  host                  = "*"
  operation             = "READ"
  permission_type       = "ALLOW"
  cluster_api_url       = redpanda_cluster.test.cluster_api_url
}


variable "user_name" {
  default = "test-username"
}

variable "user_pw" {
  default = "password"
}

variable "mechanism" {
  default = "scram-sha-256"
}

variable "topic_name" {
  default = "test-topic"
}

variable "partition_count" {
  default = 3
}

variable "replication_factor" {
  default = 3
}
```

### On GCP

```terraform
provider "redpanda" {}

resource "redpanda_resource_group" "test" {
  name = var.resource_group_name
}

resource "redpanda_network" "test" {
  name              = var.network_name
  resource_group_id = redpanda_resource_group.test.id
  cloud_provider    = var.cloud_provider
  region            = var.region
  cluster_type      = "dedicated"
  cidr_block        = "10.0.0.0/20"
}

resource "redpanda_cluster" "test" {
  name              = var.cluster_name
  resource_group_id = redpanda_resource_group.test.id
  network_id        = redpanda_network.test.id
  cloud_provider    = var.cloud_provider
  region            = var.region
  cluster_type      = "dedicated"
  connection_type   = "public"
  throughput_tier   = var.throughput_tier
  zones             = var.zones
  allow_deletion    = true
  tags = {
    "key" = "value"
  }
  #   gcp_private_service_connect = {
  #     enabled               = true
  #     global_access_enabled = true
  #     consumer_accept_list = [
  #       {
  #         source = "projects/123456789012"
  #       }
  #     ]
  #   }
}

variable "cluster_name" {
  default = ""
}

variable "resource_group_name" {
  default = ""
}

variable "network_name" {
  default = ""
}

variable "region" {
  default = "us-central1"
}

variable "zones" {
  default = ["us-central1-a", "us-central1-b", "us-central1-c"]
}

variable "cloud_provider" {
  default = "gcp"
}

variable "throughput_tier" {
  default = "tier-1-gcp-um4g"
}


resource "redpanda_user" "test" {
  name            = var.user_name
  password        = var.user_pw
  mechanism       = var.mechanism
  cluster_api_url = redpanda_cluster.test.cluster_api_url
}

resource "redpanda_topic" "test" {
  name               = var.topic_name
  partition_count    = var.partition_count
  replication_factor = var.replication_factor
  cluster_api_url    = redpanda_cluster.test.cluster_api_url
  allow_deletion     = true
}


resource "redpanda_acl" "test" {
  resource_type         = "TOPIC"
  resource_name         = redpanda_topic.test.name
  resource_pattern_type = "LITERAL"
  principal             = "User:${redpanda_user.test.name}"
  host                  = "*"
  operation             = "READ"
  permission_type       = "ALLOW"
  cluster_api_url       = redpanda_cluster.test.cluster_api_url
}


variable "user_name" {
  default = "test-username"
}

variable "user_pw" {
  default = "password"
}

variable "mechanism" {
  default = "scram-sha-256"
}

variable "topic_name" {
  default = "test-topic"
}

variable "partition_count" {
  default = 3
}

variable "replication_factor" {
  default = 3
}
```

## Limitations

We are not currently able to support the provisioning of "BYOC" clusters using this provider. A workaround is available

 * First use [RPK](https://docs.redpanda.com/current/deploy/deployment-option/cloud/create-byoc-cluster-aws/) to provision the cluster
 * Then use the provider's redpanda_cluster data source to reference the cluster for use in other resources.

### Example Usage of a data source BYOC to manage users and ACLs

```terraform
provider "redpanda" {}

variable "cluster_id" {
  default = ""
}

data "redpanda_cluster" "test" {
  id = var.cluster_id
}

resource "redpanda_topic" "test" {
  name               = var.topic_name
  partition_count    = var.partition_count
  replication_factor = var.replication_factor
  cluster_api_url    = data.redpanda_cluster.test.cluster_api_url
  allow_deletion     = true
  configuration      = var.topic_config
}

resource "redpanda_user" "test" {
  name            = var.user_name
  password        = var.user_pw
  mechanism       = var.mechanism
  cluster_api_url = data.redpanda_cluster.test.cluster_api_url
}

resource "redpanda_acl" "test" {
  resource_type         = "CLUSTER"
  resource_name         = "kafka-cluster"
  resource_pattern_type = "LITERAL"
  principal             = "User:${redpanda_user.test.name}"
  host                  = "*"
  operation             = "ALTER"
  permission_type       = "ALLOW"
  cluster_api_url       = data.redpanda_cluster.test.cluster_api_url
}

variable "topic_config" {
  default = {
    "cleanup.policy"   = "compact"
    "flush.ms"         = 100
    "compression.type" = "snappy"
  }
}

variable "user_name" {
  default = "test-username"
}

variable "user_pw" {
  default = "password"
}

variable "mechanism" {
  default = "scram-sha-256"
}

variable "topic_name" {
  default = "test-topic"
}

variable "partition_count" {
  default = 3
}

variable "replication_factor" {
  default = 3
}
```

## Import

```shell
terraform import resource.redpanda_cluster.example clusterId
```

